/**
This notice must be untouched at all times.
This is the COMPRESSED version of Draw2D
WebSite: http://www.draw2d.org
Copyright: 2006 Andreas Herz. All rights reserved.
Created: 5.11.2006 by Andreas Herz (Web: http://www.freegroup.de )
LICENSE: LGPL
**/

BezierConnectionRouter=function(_8b4){if(!_8b4){this.cheapRouter=new ManhattanConnectionRouter();}else{this.cheapRouter=null;}this.iteration=5;};BezierConnectionRouter.prototype=new ConnectionRouter;BezierConnectionRouter.prototype.type="BezierConnectionRouter";BezierConnectionRouter.prototype.drawBezier=function(_8b5,_8b6,t,iter){var n=_8b5.length-1;var q=new Array();var _8bb=n+1;for(var i=0;i<_8bb;i++){q[i]=new Array();q[i][0]=_8b5[i];}for(var j=1;j<=n;j++){for(var i=0;i<=(n-j);i++){q[i][j]=new Point((1-t)*q[i][j-1].x+t*q[i+1][j-1].x,(1-t)*q[i][j-1].y+t*q[i+1][j-1].y);}}var c1=new Array();var c2=new Array();for(var i=0;i<n+1;i++){c1[i]=q[0][i];c2[i]=q[i][n-i];}if(iter>=0){this.drawBezier(c1,_8b6,t,--iter);this.drawBezier(c2,_8b6,t,--iter);}else{for(var i=0;i<n;i++){_8b6.push(q[i][n-i]);}}};BezierConnectionRouter.prototype.route=function(conn){if(this.cheapRouter!=null&&(conn.getSource().getParent().isMoving==true||conn.getTarget().getParent().isMoving==true)){this.cheapRouter.route(conn);return;}var _8c1=new Array();var _8c2=conn.getStartPoint();var toPt=conn.getEndPoint();this._route(_8c1,conn,toPt,this.getEndDirection(conn),_8c2,this.getStartDirection(conn));var _8c4=new Array();this.drawBezier(_8c1,_8c4,0.5,this.iteration);for(var i=0;i<_8c4.length;i++){conn.addPoint(_8c4[i]);}conn.addPoint(toPt);};BezierConnectionRouter.prototype._route=function(_8c6,conn,_8c8,_8c9,toPt,_8cb){var TOL=0.1;var _8cd=0.01;var _8ce=90;var UP=0;var _8d0=1;var DOWN=2;var LEFT=3;var _8d3=_8c8.x-toPt.x;var _8d4=_8c8.y-toPt.y;var _8d5;var dir;if(((_8d3*_8d3)<(_8cd))&&((_8d4*_8d4)<(_8cd))){_8c6.push(new Point(toPt.x,toPt.y));return;}if(_8c9==LEFT){if((_8d3>0)&&((_8d4*_8d4)<TOL)&&(_8cb==_8d0)){_8d5=toPt;dir=_8cb;}else{if(_8d3<0){_8d5=new Point(_8c8.x-_8ce,_8c8.y);}else{if(((_8d4>0)&&(_8cb==DOWN))||((_8d4<0)&&(_8cb==UP))){_8d5=new Point(toPt.x,_8c8.y);}else{if(_8c9==_8cb){var pos=Math.min(_8c8.x,toPt.x)-_8ce;_8d5=new Point(pos,_8c8.y);}else{_8d5=new Point(_8c8.x-(_8d3/2),_8c8.y);}}}if(_8d4>0){dir=UP;}else{dir=DOWN;}}}else{if(_8c9==_8d0){if((_8d3<0)&&((_8d4*_8d4)<TOL)&&(_8cb==LEFT)){_8d5=toPt;dir=_8cb;}else{if(_8d3>0){_8d5=new Point(_8c8.x+_8ce,_8c8.y);}else{if(((_8d4>0)&&(_8cb==DOWN))||((_8d4<0)&&(_8cb==UP))){_8d5=new Point(toPt.x,_8c8.y);}else{if(_8c9==_8cb){var pos=Math.max(_8c8.x,toPt.x)+_8ce;_8d5=new Point(pos,_8c8.y);}else{_8d5=new Point(_8c8.x-(_8d3/2),_8c8.y);}}}if(_8d4>0){dir=UP;}else{dir=DOWN;}}}else{if(_8c9==DOWN){if(((_8d3*_8d3)<TOL)&&(_8d4<0)&&(_8cb==UP)){_8d5=toPt;dir=_8cb;}else{if(_8d4>0){_8d5=new Point(_8c8.x,_8c8.y+_8ce);}else{if(((_8d3>0)&&(_8cb==_8d0))||((_8d3<0)&&(_8cb==LEFT))){_8d5=new Point(_8c8.x,toPt.y);}else{if(_8c9==_8cb){var pos=Math.max(_8c8.y,toPt.y)+_8ce;_8d5=new Point(_8c8.x,pos);}else{_8d5=new Point(_8c8.x,_8c8.y-(_8d4/2));}}}if(_8d3>0){dir=LEFT;}else{dir=_8d0;}}}else{if(_8c9==UP){if(((_8d3*_8d3)<TOL)&&(_8d4>0)&&(_8cb==DOWN)){_8d5=toPt;dir=_8cb;}else{if(_8d4<0){_8d5=new Point(_8c8.x,_8c8.y-_8ce);}else{if(((_8d3>0)&&(_8cb==_8d0))||((_8d3<0)&&(_8cb==LEFT))){_8d5=new Point(_8c8.x,toPt.y);}else{if(_8c9==_8cb){var pos=Math.min(_8c8.y,toPt.y)-_8ce;_8d5=new Point(_8c8.x,pos);}else{_8d5=new Point(_8c8.x,_8c8.y-(_8d4/2));}}}if(_8d3>0){dir=LEFT;}else{dir=_8d0;}}}}}}this._route(_8c6,conn,_8d5,dir,toPt,_8cb);_8c6.push(_8c8);};